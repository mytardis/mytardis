FROM mytardis/mytardis-base

# prebuilt wheels from django-build.yml
ADD wheelhouse /wheelhouse

USER webapp

WORKDIR /home/webapp

ENV DOCKER_BUILD true
RUN . /appenv/bin/activate; \
    pip install --no-index -f /wheelhouse -r requirements.txt
RUN npm install --production
RUN npm run-script build
EXPOSE 8000
CMD ["python3","manage.py","runserver","0.0.0.0:8000"]